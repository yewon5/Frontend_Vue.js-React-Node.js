<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /*
        const delayAdd = (index, cb, errorCb) => { //cb정상처리, errorCb오류처리
            setTimeout(() => {
                if(index > 10) {
                    errorCb(`${index}는 10보다 클 수 없다.`)
                    return;
                }
                console.log(index)
                cb(index+1);
            }, 1000);
        }
        delayAdd(11, 
            //정상처리 함수
            (res)=>{
                console.log(res); //버퍼에 출력할 내용을 모아놨다가 일괄 처리
            }, 
            //오류처리 함수
            (err)=>{
                console.error(err); //에러는 버퍼가 없음
            } 
        );
        */

        //promise객체로 변경
        const delayAdd = index => {
            return new Promise((resolve, reject) => { //정상, 오류변수
                setTimeout(() => {
                    if(index > 10) {
                        reject(`${index}는 10보다 클 수 없다.`) //오류
                        return;
                    }
                    console.log(index)
                    resolve(index+1); //정상
                }, 1000);
            });
        };

        /*
        delayAdd(11)
            .then((res)=>{console.log(res)}) 
            .catch((err)=>{console.error(err)})
            .finally(()=>{console.log("Done!")})
        */


        //async await로 변경 (try-catch 사용)
        const wrap = async () => {
            try{
                const res = await delayAdd(11);
                console.log(res)
            }
            catch(err) {
                console.error(err)
            }
            finally {
                console.log("Done!")
            }
        }

        wrap();


    </script>
</body>
</html>